(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1261],{46601:function(){},20750:function(e,t,a){"use strict";a.d(t,{aw:function(){return getBlastPoints},l3:function(){return getInviteCodes},dH:function(){return getInvitees},Vm:function(){return getPtypoolYields},Zr:function(){return getRank},V_:function(){return getUserState},M0:function(){return refreshInviteCode},n$:function(){return userLogin}});var n=a(92173),s=a(97489);let o=n.Z.create({baseURL:(s.O,"https://earlyaccess-beta.wand.fi/api"),timeout:1e4,headers:{"Content-Type":"application/json"}});var r={get:async function(e){var t;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e.startsWith("/auth")){let e=localStorage.getItem("earlyaccess-token");if(!e)throw"Need token";n.headers={...n.headers||{},Authorization:e}}let s=await o.get(e,{...n,params:a});if(console.info("res:",null==s?void 0:s.data),(null==s?void 0:null===(t=s.data)||void 0===t?void 0:t.code)!==200)throw s.data;return s.data.data},post:async function(e){var t;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e.startsWith("/auth")){let e=localStorage.getItem("earlyaccess-token");if(!e)throw"Need token";n.headers={...n.headers||{},Authorization:e}}let s=await o.post(e,a,n);if((null==s?void 0:null===(t=s.data)||void 0===t?void 0:t.code)!==200)throw s.data;return s.data.data}};let getRank=async()=>{let e=await r.get("/common/leader");return e},userLogin=async e=>{let t=await r.post("/auth/register",{code:e});return t},getUserState=async()=>{let e=await r.get("/auth/userState");return e},getBlastPoints=async()=>{let e=await r.get("/auth/blastPoints");return e},getInviteCodes=async()=>{let e=await r.get("/auth/invite/codes");return e},getInvitees=async()=>{let e=await r.get("/auth/invitees");return e},refreshInviteCode=async()=>(await r.post("/auth/invite/code/create"),getInviteCodes()),getPtypoolYields=async()=>{let e=await r.get("/common/ptypool/yields");return e}},23653:function(e,t,a){"use strict";a.d(t,{l:function(){return getTokens}});var n=a(72009);let getTokens=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return n.iK[e].map(e=>({symbol:e.assetTokenSymbol,address:e.assetTokenAddress})).concat(n.iK[e].map(e=>({symbol:e.xTokenSymbol,address:e.xTokenAddress}))).concat([{symbol:"USB",address:n.O1[e]}]).filter(e=>!t||"ETH"!==e.symbol)}},8580:function(e,t,a){"use strict";a.d(t,{Hj:function(){return s},Pq:function(){return r},pn:function(){return l},v:function(){return n},xb:function(){return o}});let n="https://twitter.com/WandProtocol",s="https://discord.gg/fy6A7JCE5N",o="https://docs.wand.fi",r=BigInt(1e18),l=864e5},23862:function(e,t,a){"use strict";a.d(t,{b:function(){return useMemoOfChainId}});var n=a(2265),s=a(14389);function useMemoOfChainId(e){let t=(0,s.p)(),a=(0,n.useRef)({});return(0,n.useMemo)(()=>(a.current[t]||(a.current[t]=e()),a.current[t]),[t])}},86825:function(e,t,a){"use strict";a.d(t,{i:function(){return d},p:function(){return useUpdatePtypoolApy}});var n=a(72009),s=a(8580),o=a(81628),r=a(2890),l=a.n(r),u=a(74738),i=a(14389);let d=(0,u.Ue)(e=>({update:e}));function useUpdatePtypoolApy(e,t,a){let r=(0,i.p)(),u=n.iK[r];u.forEach(u=>{u.ptyPoolAboveAddress&&(null==t?void 0:t[u.ptyPoolAboveAddress])&&e[u.ptyPoolAboveAddress]&&d.getState().update({[u.ptyPoolAboveAddress]:{staking:(a=>{if(!t)return 0n;let n=l().mapValues(t[a].staking,e=>BigInt(e)),r=e[a],u=(0,o.ok)(n,"block")-(0,o.ok)(n,"matchedBlock"),i=(0,o.ok)(n,"yields"),d=BigInt(15379200),c=u>0n&&r.totalStake>0n?i*d*s.Pq/u/r.totalStake:0n;return c*BigInt(1e10)/s.Pq})(u.ptyPoolAboveAddress),matching:0n}}),u.ptyPoolBelowAddress&&(null==t?void 0:t[u.ptyPoolBelowAddress])&&e[u.ptyPoolBelowAddress]&&d.getState().update({[u.ptyPoolBelowAddress]:{staking:(i=>{if(!t)return 0n;let d=l().mapValues(t[i].staking,e=>BigInt(e)),c=e[i],b=(0,o.ok)(d,"block")-(0,o.ok)(d,"matchedBlock"),m=(0,o.ok)(d,"yields"),p=BigInt(15379200),v=b>0n&&c.totalStake>0n?m*a[u.xTokenAddress]*p*s.Pq/b/(c.totalStake*a[n.O1[r]]):0n;return console.info("buyStakingApy:",v,m,b,c.totalStake,p),v*BigInt(1e10)/s.Pq})(u.ptyPoolBelowAddress),matching:0n}})})}},68497:function(e,t,a){"use strict";a.d(t,{g:function(){return B},A:function(){return FetcherProvider}});var n=a(57437),s=a(34873),o=a(20750),r=a(72009),l=a(23653),u=a(8580),i=a(14389),d=a(2265),c=a(56926),b=a(32699),m=a(93362),p=a(91056),v=a(23862),f=a(86825),k=a(54415),g=a(81628),h=a(2890),y=a.n(h),S=a(24033),A=a(38092),P=a(21693),T=a(16775),Y=a(7935);let B=(0,d.createContext)({balances:(0,g.Yb)({},0n),totalSupplies:(0,g.Yb)({},0n),prices:(0,g.Yb)({},0n),assetLocked:(0,g.Yb)({},0n),aar:(0,g.Yb)({},0),vaultUSBTotal:(0,g.Yb)({},0n),vaultsMode:(0,g.Yb)({},0),vaultsDiscount:(0,g.Yb)({},!1),vaultsState:(0,g.Yb)({},(0,g.Yb)({},0n)),stableVaultsState:(0,g.Yb)({},(0,g.Yb)({},0n)),earns:(0,g.Yb)({},0n),usbApr:{apr:0n,aprDecimals:10}}),FetcherProvider=e=>{let{children:t}=e,a=(0,S.usePathname)(),h="/"!=a,w=(0,i.p)();!function(){let{chainId:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,c.t_)({chainId:e});d.useMemo(()=>{let e=function(e){var t,a;let{chain:n,transport:s}=e,o={chainId:n.id,name:n.name,ensAddress:null===(a=n.contracts)||void 0===a?void 0:null===(t=a.ensRegistry)||void 0===t?void 0:t.address};return"fallback"===s.type?new b.H(s.transports.map(e=>{let{value:t}=e;return new m.r(null==t?void 0:t.url,o)})):new m.r(s.url,o)}(t);return p.ON.provider=e,e},[t])}();let{address:I}=(0,c.mA)(),{data:N}=(0,c.KQ)({address:I,enabled:!!I&&h,chainId:w}),M=(0,d.useMemo)(()=>(0,l.l)(w),[w]),{data:U}=(0,k.uX)({contracts:[...M.map(e=>({address:e.address,abi:Y.em,functionName:"balanceOf",args:[I],chainId:w}))],enabled:I&&h}),{data:C}=(0,k.uX)({contracts:[...M.map(e=>({address:e.address,abi:Y.em,functionName:"totalSupply",chainId:w}))],enabled:h}),_=(0,v.b)(()=>(0,g.Yb)({},0n));_[r.K8]=(null==N?void 0:N.value)||0n,M.forEach((e,t)=>{_[e.address]=(0,g.ok)(U,[t,"result"])});let W=(0,v.b)(()=>(0,g.Yb)({},0n));M.forEach((e,t)=>{W[e.address]=(0,g.ok)(C,[t,"result"])});let E=r.iK[w],X=function(){let e=(0,S.usePathname)(),t="/"!=e,a=(0,i.p)(),n=r.iK[a],{data:o}=(0,k.uX)({enabled:t,contracts:[...n.map(e=>({vc:e,abi:s.nq,address:e.assetTokenFeed,functionName:"latestPrice"}))]}),{data:l}=(0,k.uX)({cacheTime:u.pn,enabled:t,contracts:[...n.map(e=>({abi:s.nq,address:e.assetTokenFeed,functionName:"decimals"}))]});return(0,d.useMemo)(()=>{let e={};return n.forEach((t,a)=>{let n=(0,g.ok)(o,[a,"result"]),s=(0,g.ok)(l,[a,"result"]);e[t.assetTokenAddress]=[n,s]}),e},[o,l,n])}(),{data:q}=(0,k.uX)({enabled:h,contracts:[...E.map(e=>({vc:e,abi:s.WW,address:e.vault,functionName:"assetBalance"}))]}),{data:D}=(0,k.uX)({enabled:h,contracts:[...E.map(e=>({abi:s.WW,address:e.vault,functionName:"usbTotalSupply"}))]}),{data:x}=(0,k.uX)({enabled:h,contracts:[...E.map(e=>({vc:e,abi:s.Wn,address:r.O6[w],functionName:"AAR",args:[e.vault]}))]}),{data:O}=(0,k.uX)({cacheTime:u.pn,enabled:h,contracts:[...E.map(e=>({abi:s.WW,address:e.vault,functionName:"AARDecimals"}))]}),{data:R}=(0,k.uX)({enabled:h,contracts:[...E.map(e=>({abi:s.WW,address:e.vault,functionName:"vaultMode"}))]}),{data:K}=(0,k.uX)({enabled:h,contracts:[...E.map(e=>({vc:e,abi:s.Wn,address:r.O6[w],functionName:e.isStable?"getStableVaultState":"getVaultState",args:[e.vault]}))]}),{data:V}=(0,k.uX)({cacheTime:u.pn,enabled:h,contracts:[...E.map(e=>({vc:e,abi:s.WW,address:e.vault,functionName:"paramValue",args:[(0,P.$G)("Y",{size:32})]}))]}),F=(0,v.b)(()=>(0,g.Yb)({[r.O1[w]]:u.Pq},0n)),H=(0,v.b)(()=>(0,g.Yb)({},0n)),L=(0,v.b)(()=>(0,g.Yb)({},0n)),z=(0,v.b)(()=>(0,g.Yb)({},0n)),j=(0,v.b)(()=>(0,g.Yb)({},0)),Z=(0,v.b)(()=>(0,g.Yb)({},(0,g.Yb)({},0n))),$=(0,v.b)(()=>(0,g.Yb)({},(0,g.Yb)({},0n))),G=function(e,t,a){let n=(0,v.b)(()=>(0,g.Yb)({},!1)),o=(0,i.p)(),l=r.iK[o],{data:u}=(0,k.uX)({contracts:l.map(e=>({vc:e,abi:s.WW,address:e.vault,functionName:"paramValue",args:[(0,P.$G)("CircuitBreakPeriod",{size:32})]}))});return l.forEach((s,o)=>{if(s.isStable){let e=t[(null==s?void 0:s.vault)||"null"];n[s.vault]=e&&e.M_USDCx>0n&&e.aar<e.AARS}else{let t=(0,g.ok)(u,[o,"result"]),r=e[(null==s?void 0:s.vault)||"null"],l=a[(null==s?void 0:s.vault)||"null"],i=(0,g.ok)(r,"AARBelowCircuitBreakerLineTime"),d=2==l&&r&&((0,g.ok)(r,"aar")>=(0,g.ok)(r,"AARC")||BigInt(new Date().getTime()/1e3)-i>=t);n[s.vault]=d}}),n}(Z,$,j);E.forEach((e,t)=>{var a,n,s;let o=(0,g.ok)(q,[t,"result"]),l=(0,g.ok)(D,[t,"result"]),i=(0,g.ok)(X[e.assetTokenAddress],[0]),d=(0,g.ok)(X[e.assetTokenAddress],[1]);z[e.vault]=l;let c=d>0n?i*u.Pq/10n**d:0n;F[e.assetTokenAddress]=c;let b=W[e.xTokenAddress],m=b>0n&&o>0n&&c>0n&&l>0n&&o*c>l*u.Pq?(o*c-l*u.Pq)/b:0n;b>0n&&o>0n&&c>0n&&l>0n&&o*c<l*u.Pq&&(F[r.O1[w]]=o*c/l),F[e.xTokenAddress]=m,H[e.assetTokenAddress]=o;let p=(0,T.b)((0,g.ok)(x,[t,"result"]),parseInt((0,g.ok)(O,[t,"result"]).toString()));L[e.vault]=parseFloat(p),e.isStable?$[e.vault]=(0,g.Yb)({settingsDecimals:10n,...null==K?void 0:null===(n=K[t])||void 0===n?void 0:n.result,Y:(0,g.ok)(V,[t,"result"])},0n):Z[e.vault]=(0,g.Yb)({settingsDecimals:10n,...null==K?void 0:null===(s=K[t])||void 0===s?void 0:s.result,Y:(0,g.ok)(V,[t,"result"])},0n);let v=$[e.vault];j[e.vault]=e.isStable?v.aar<v.AARS&&v.M_USDC>0n?2:1:(null==R?void 0:null===(a=R[t])||void 0===a?void 0:a.result)||0});let J=function(){let{address:e}=(0,c.mA)(),t=(0,S.usePathname)(),a=(0,i.p)(),n=(0,d.useMemo)(()=>r.iK[a].filter(e=>!e.isStable&&e.ptyPoolAboveAddress&&e.ptyPoolBelowAddress).map(e=>[{poolAddress:e.ptyPoolBelowAddress,stakeSymbol:"USB",matchSymbol:e.assetTokenSymbol,earnSymbol:e.xTokenSymbol,earnForMatchSymbol:e.assetTokenSymbol},{poolAddress:e.ptyPoolAboveAddress,stakeSymbol:e.assetTokenSymbol,matchSymbol:"USB",earnSymbol:e.assetTokenSymbol,earnForMatchSymbol:e.xTokenSymbol}]).flat(),[a]),{data:o}=(0,k.uX)({enabled:"/earn"==t&&!!e,contracts:[...n.map(t=>{let{poolAddress:a}=t;return{abi:s.aT,address:a,functionName:"userStakingBalance",args:[e]}}),...n.map(t=>{let{poolAddress:a}=t;return{abi:s.aT,address:a,functionName:"earnedMatchedToken",args:[e]}}),...n.map(t=>{let{poolAddress:a}=t;return{abi:s.aT,address:a,functionName:"earnedStakingYields",args:[e]}}),...n.map(t=>{let{poolAddress:a}=t;return{abi:s.aT,address:a,functionName:"earnedMatchingYields",args:[e]}})]}),{data:l}=(0,k.uX)({enabled:"/earn"==t,contracts:[...n.map(e=>{let{poolAddress:t}=e;return{abi:s.aT,address:t,functionName:"totalStakingBalance"}})]}),u=(0,v.b)(()=>(0,g.Yb)({},(0,g.Yb)({},0n)));return n.forEach((e,t)=>{let{poolAddress:a,stakeSymbol:s,matchSymbol:r,earnSymbol:i}=e,d=(0,g.ok)(o,[t,"result"]),c=(0,g.ok)(o,[t+n.length,"result"]),b=(0,g.ok)(o,[t+2*n.length,"result"]),m=(0,g.ok)(o,[t+3*n.length,"result"]),p=(0,g.ok)(l,[t,"result"]);u[a]={stakeSymbol:s,matchSymbol:r,earnSymbol:i,stake:d,match:c,earn:b,earnForMatch:m,totalStake:p}}),u}(),Q=function(e,t){let a=(0,i.p)(),n=0,s=0n,o=0n;return r.iK[a].forEach(a=>{if(a.isStable){let e=t[a.vault];s+=e.M_USB_USDC*e.Y,o+=e.M_USB_USDC,e.M_USB_USDC>0n&&e.Y>0n&&n++}else{let t=e[a.vault];s+=t.M_USB_ETH*t.Y,o+=t.M_USB_ETH,t.M_USB_ETH>0n&&t.Y>0n&&n++}}),{apr:o>0n?s/o:0n,aprDecimals:10}}(Z,$);(0,d.useEffect)(()=>{setInterval(()=>{let e=k.hp.getState();y().now()-e.time>=36e5&&e.update()},36e5)},[]);let ee=(0,k.hp)(),{value:et={}}=(0,A.Z)(o.Vm,[ee.time]);return(0,f.p)(J,et,F),(0,n.jsx)(B.Provider,{value:{balances:_,totalSupplies:W,prices:F,assetLocked:H,aar:L,vaultUSBTotal:z,vaultsMode:j,vaultsDiscount:G,vaultsState:Z,stableVaultsState:$,earns:J,usbApr:Q,ptypoolYields:et},children:t})}}}]);