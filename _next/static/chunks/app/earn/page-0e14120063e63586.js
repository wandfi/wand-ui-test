(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[50],{35883:function(){},14034:function(e,t,s){"use strict";s.d(t,{Z:function(){return d}});var a=s(50044),n=s(2265),l=s(16737),r=s(37517),i=s(93568),c=s(76503);let o=(0,i.fn)("Divider"),d=n.forwardRef((e,t)=>{let{className:s}=e,i=(0,a.__rest)(e,["className"]);return n.createElement("div",Object.assign({ref:t,className:(0,c.q)(o("root"),"w-full mx-auto","bg-tremor-background-subtle","dark:bg-dark-tremor-background-subtle",l.N.threeXs.height,r.W.threeXl.marginTop,r.W.threeXl.marginBottom,s)},i))});d.displayName="Divider"},55139:function(e,t,s){"use strict";s.d(t,{r:function(){return a.Z}});var a=s(87456)},62166:function(e,t,s){Promise.resolve().then(s.bind(s,66790))},66790:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return EarnPage}});var a=s(57437),n=s(84486),l=s(91056),r=s(72009),i=s(8580),c=s(2265);let o={};var d=s(54415),u=s(43003),m=s(81628),x=s(15898),h=s(20373),f=s(14034),b=s(87456),p=s(57042),v=s(16691),g=s.n(v),k=s(79352),j=s(56926),y=s(76036),w=s(34776),N=s(80547),T=s(72084),S=s(64020),A=s(51549);function TokenValue(e){let{symbol:t,value:s,decimals:n}=e;return(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(g(),{className:"inline-block",alt:"usb",width:16,height:16,src:"/".concat(t,".svg")}),(0,h.dq)(s,n)]})}function DualTokenCard(e){let{type:t,vc:s}=e,p="buy"==t;(0,j.xx)();let v=p?r.O1[(0,l.BV)()]:s.assetTokenAddress,g=p?"USB":s.assetTokenSymbol,C=p?r.O1[(0,l.BV)()]:s.assetTokenAddress,R=p?s.assetTokenSymbol:"USB",B=p?"Buy ".concat(s.assetTokenSymbol," Low"):"Sell ".concat(s.assetTokenSymbol," High"),_=p?s.ptyPoolBelowAddress:s.ptyPoolAboveAddress,{prices:E,balances:P,earns:M,vaultsState:z,assetLocked:D,vaultUSBTotal:V}=(0,c.useContext)(x.g),W=z[s.vault],q=M[_],{address:I}=(0,j.mA)(),Z=P[g],[F,H]=(0,c.useState)(""),U=(0,m.su)(F),L=p?s.xTokenSymbol:s.assetTokenSymbol,O=p?s.assetTokenSymbol:s.xTokenSymbol,Y=(0,c.useMemo)(()=>q.totalStake*(0,m.ok)(E,C,i.Pq)/i.Pq,[E[C],q.totalStake]),$=p?null==W?void 0:W.AARS:null==W?void 0:W.AARU,G=(0,m.ok)(D,s.assetTokenAddress),X=(0,m.ok)(V,s.vault),J=(0,c.useMemo)(()=>$&&W.AARDecimals&&0n!=G&&0n!=X?$*X*i.Pq/W.AARDecimals/G/BigInt(1e9):(0,m.ok)(E,s.assetTokenAddress),[$,X,W.AARDecimals,G]),K=p?"Stake $USB, and when the ".concat(s.assetTokenSymbol," price falls to the target, it will trigger the purchase of ").concat(s.assetTokenSymbol," with staked $USB."):"Stake ".concat(s.assetTokenSymbol,", and when the ").concat(s.assetTokenSymbol," price rises to the target, staked ").concat(s.assetTokenSymbol," will be sold."),Q=(0,c.useMemo)(()=>({abi:n.aT,address:_,functionName:"getAccruedMatchingYields",watch:!0}),[_]),ee=(0,d.D2)(Q),et=(0,m.ok)(ee,"data"),es=(0,c.useMemo)(()=>{let e=(0,m.ok)(q,"totalStake");return 0n==e?"0.00%":(0,m.Jh)(et*i.Pq/e,18,2)},[q.totalStake,et]),ea=(0,c.useMemo)(()=>"2.00%",[Y]),en=(0,c.useMemo)(()=>{let e=p?[{key:"eth_price",label:"ETH Price",value:(0,h.dq)(E[s.assetTokenAddress])},{key:"target_price",label:"Target Price",value:(0,h.dq)(J)},{key:"apr_yield",label:"APR(".concat(L," Yield)"),value:ea},{key:"apr_interest",label:"APR(USB Interest)",value:(0,m.Jh)((0,m.ok)(W,"Y"),(0,m.ok)(W,"settingsDecimals"),2)},{key:"transacation_reward_pool",label:"Reward Pool",tip:"The reward funds originates from protocol, and when a purchase action is triggered, these funds will be distributed proportionally.",value:(0,a.jsx)(TokenValue,{symbol:O,value:et})},{key:"discount_rate",label:"Reward Rate",tip:"This is an estimated value, to be determined upon triggering. Reward Rate =Reward/Transaction volume",value:"".concat(es," (Est.)")}]:[{key:"eth_price",label:"ETH Price",value:(0,h.dq)(E[s.assetTokenAddress])},{key:"target_price",label:"Target Price",value:(0,h.dq)(J)},{key:"apr_yield",label:"APR(".concat(L," Yield)"),value:ea},{key:"transacation_reward_pool",label:"Reward Pool",tip:"The reward funds originates from protocol, and when a purchase action is triggered, these funds will be distributed proportionally.",value:(0,a.jsx)(TokenValue,{symbol:O,value:et})},{key:"discount_rate",label:"Reward Rate",tip:"This is an estimated value, to be determined upon triggering. Reward Rate =Reward/Transaction volume",value:"".concat(es," (Est.)")}];return e},[q,et]),el=(0,c.useMemo)(()=>{let e=p?[{key:"successfully_brought",label:"Successfully Brought",value:(0,a.jsx)(TokenValue,{symbol:R,value:q.match})},{key:"x_earend",label:"".concat(L," earned"),value:(0,a.jsx)(TokenValue,{symbol:L,value:q.earn})}]:[{key:"successfully_sold",label:"Successfully Sold",value:(0,a.jsx)(TokenValue,{symbol:R,value:q.match})},{key:"x_earend",label:"".concat(O," earned"),value:(0,a.jsx)(TokenValue,{symbol:O,value:q.earnForMatch})}];return e},[q,et]),{write:er,isDisabled:ei,isLoading:ec}=(0,u.R)({abi:n.aT,address:_,functionName:"claimAll"}),eo=function(e){let t=(0,c.useRef)(null);return o[e]&&o[e].includes(t)||(o[e]=[...o[e]||[],t]),(0,c.useEffect)(()=>{if(!t.current)return()=>{};let onResize=()=>{let s=o[e]||[],a=s.reduce((e,t)=>{var s;return Math.max((null===(s=t.current)||void 0===s?void 0:s.clientHeight)||0,e)},0);s.filter(e=>e!=t).forEach(e=>{var t;let s=(null===(t=e.current)||void 0===t?void 0:t.clientHeight)||0;s!==a&&a>0&&e.current&&(e.current.style.height="".concat(a,"px"))})};return window.addEventListener("resize",onResize),onResize(),()=>{window.removeEventListener("resize",onResize)}},[t.current]),t}(s.vault);return(0,a.jsxs)("div",{className:"card flex flex-col",children:[(0,a.jsxs)("div",{className:"flex gap-5 items-center justify-between",ref:eo,children:[(0,a.jsxs)("div",{className:"flex gap-3 md:gap-5 items-center",children:[(0,a.jsxs)("div",{className:"relative w-fit shrink-0",children:[(0,a.jsx)(A.c,{size:32,symbol:g,className:"md:hidden"}),(0,a.jsx)(A.c,{size:40,symbol:g,className:"hidden md:block"}),(0,a.jsx)(A.c,{size:16,symbol:R,className:"absolute -right-1 -bottom-1 md:hidden"}),(0,a.jsx)(A.c,{size:24,symbol:R,className:"absolute -right-2 -bottom-2 hidden md:block"})]}),(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("h6",{className:"text-base leading-6 font-bold",children:B||"title"}),(0,a.jsx)(S.C,{children:K})]})})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-xs text-black font-medium text-right",children:["Total ",g," Staked"]}),(0,a.jsx)("div",{className:"text-base text-black text-end font-semibold",children:(0,h.dq)(q.totalStake)})]})]}),(0,a.jsx)(f.Z,{className:"my-4"}),(0,a.jsxs)(b.Z,{numItemsSm:2,className:"gap-x-2 min-h-[188px]",children:[(0,a.jsx)(b.Z,{numItemsSm:1,className:"gap-y-2 gap-x-7 md:border-r-[1px] border-[#E4E4E7] mb-[12px] md-0",children:null==en?void 0:en.map(e=>(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("div",{className:"text-xs text-black font-medium mr-[5px]",children:[e.label," : ",e.tip&&(0,a.jsx)(S.C,{children:e.tip})]}),(0,a.jsx)("div",{className:"text-neutral-900 text-sm",children:e.value})]},e.key))}),I&&(0,a.jsxs)(b.Z,{numItemsSm:1,className:"gap-x-1",children:[(0,a.jsx)("div",{className:"w-full border-t-[1px] border-[#E4E4E7] md:border-0 md:px-[20px]",children:null==el?void 0:el.map(e=>(0,a.jsxs)("div",{className:"flex items-center mt-[8px] md:mt-0 md:mb-2",children:[(0,a.jsxs)("div",{className:"text-xs text-black font-medium mr-[5px]",children:[e.label," :"]}),(0,a.jsx)("div",{className:"text-neutral-900 text-sm",children:e.value})]},e.key))}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"w-full flex justify-center items-center",children:(0,a.jsxs)("button",{className:"btn-primary px-4 h-7 flex items-center w-[60%] md:w-fit self-end justify-center gap-4 bg-[#64738B]",disabled:ei||ec,onClick:()=>er(),children:[ec&&(0,a.jsx)(T.$,{}),"Claim All"]})}),(0,a.jsxs)("div",{className:"flex mt-4 md:mt-[28px] justify-center items-center text-[#64748B] text-base font-medium",children:["Staked: ",(0,h.dq)(q.stake)," ",(0,a.jsx)("span",{className:"text-[#6466F1] ml-[5px] cursor-pointer",onClick:()=>H((0,k.d)(q.stake)),children:"Max"})]})]})]})]}),(0,a.jsx)("div",{className:"flex-1"}),(0,a.jsx)("div",{className:"flex justify-between",children:(0,a.jsx)("div",{className:"text-sm text-slate-500 flex flex-col gap-3"})}),I?(0,a.jsxs)("div",{className:"mt-4 md:mt-[30px]",children:[(0,a.jsx)(N.W,{amount:F,setAmount:H,asset:g,balance:Z,checkBalance:!1}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(y.v,{tx:"Stake",disabled:U<=0n||U>Z,onTxSuccess:()=>{H("")},config:{abi:n.aT,address:_,functionName:"stake",args:[U],value:"ETH"==g?U:0n},className:"mt-2 w-[45%]",approves:{[v]:U},spender:_}),(0,a.jsx)(y.v,{className:"mt-2 w-[45%]",tx:"Withdraw",disabled:U<=0n||U>q.stake,onTxSuccess:()=>{H("")},config:{abi:n.aT,address:_,functionName:"withdraw",args:[U]}})]})]}):(0,a.jsx)("div",{className:"w-full flex items-center justify-center mt-[30px]",children:(0,a.jsx)(w.Z,{})})]})}function GroupDualTokenCard(e){let{vcs:t,type:s}=e,[n,l]=(0,c.useState)(t[t.length-1]);return 1==t.length?(0,a.jsx)(DualTokenCard,{vc:t[0],type:s}):(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(DualTokenCard,{vc:n,type:s}),(0,a.jsx)("div",{className:"absolute z-10 left-[86px] top-0 flex text-sm",children:t.map((e,t)=>(0,a.jsx)("div",{className:(0,p.Z)("cursor-pointer rounded-b-full border border-blue-500 px-1 py-1",{"bg-white text-black":n!==e,"bg-blue-500 text-white":n===e}),onClick:()=>l(e),children:"V".concat(t+1)},"gdtc_"+t))})]})}var C=s(55139);function EarnPage(){(0,j.xx)();let e=(0,c.useMemo)(()=>r.iK[(0,l.BV)()].filter(e=>"ETH"==e.assetTokenSymbol),[(0,l.BV)()]);return(0,a.jsxs)("div",{className:"w-full h-full max-w-screen-xl px-4 mx-auto",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold",children:"Price Trigger Yield"}),(0,a.jsxs)(C.r,{numItemsMd:2,className:"gap-3 mt-4",children:[(0,a.jsx)(GroupDualTokenCard,{vcs:e,type:"buy"}),(0,a.jsx)(GroupDualTokenCard,{vcs:e,type:"sell"})]})]})}},76036:function(e,t,s){"use strict";s.d(t,{v:function(){return ApproveAndTx}});var a=s(57437),n=s(72009),l=s(81628),r=s(2265),i=s(71424),c=s(56926),o=s(84661),d=s(54415);let u={},useApproves=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10000000000n*10n**18n,{address:a}=(0,c.mA)(),m=(0,d.uT)(),{data:x}=(0,c.py)(),[h,f]=(0,r.useState)(!1),b=(0,r.useMemo)(()=>Object.keys(e).filter(e=>e!==n.K8),[e]),[p,v]=(0,r.useState)(t&&u[t]||{}),updateAllownce=(e,s)=>{t&&(u[t]={...u[t]||{},[e]:s},v(t=>({...t,[e]:s})))},{data:g}=(0,c.Ov)(),k=(0,c.t_)();(0,r.useEffect)(()=>{a&&t&&b.forEach(e=>{m({abi:o.em,address:e,functionName:"allowance",args:[a,t]}).then(t=>updateAllownce(e,t||0n)).catch(console.error)})},[b,a,g]);let[j,y]=(0,r.useState)(!1),w=(0,r.useMemo)(()=>b.filter(t=>(0,l.ok)(e,t)>0n&&(0,l.ok)(e,t)>(0,l.ok)(p,t)),[e,b,p]),approve=async()=>{if(0!=w.length&&t)try{y(!0),f(!1);for(let a=0;a<w.length;a++){let n=w[a],l=!1===s?e[n]:s,r=await (null==x?void 0:x.writeContract({abi:o.em,address:n,functionName:"approve",args:[t,l]}));r&&await (null==k?void 0:k.waitForTransactionReceipt({hash:r})),updateAllownce(n,l)}i.A.success("Approve success"),y(!1),f(!0)}catch(e){throw i.A.error((0,l.az)(e)),y(!1),f(!1),e}};return{approve,loading:j,shouldApprove:w.length>0,isSuccess:h}};var m=s(43003),x=s(35769),h=s(72084);function ApproveAndTx(e){let{className:t,tx:s,approves:n,spender:l,requestAmount:i,config:c,toast:o=!0,disabled:d,onTxSuccess:u,onApproveSuccess:f}=e,{write:b,isDisabled:p,isLoading:v}=(0,m.R)({onSuccess:()=>u&&u(),...c},o),g=d||p||v||!1===c.enabled,{approve:k,shouldApprove:j,loading:y,isSuccess:w}=useApproves(n||{},l,i),N=(0,r.useRef)();return(N.current=f,(0,r.useEffect)(()=>{N.current&&w&&N.current()},[w]),j)?(0,a.jsxs)("button",{className:(0,x.m)("btn-primary flex items-center justify-center gap-4",t),onClick:k,disabled:d||!k||y,children:[y&&(0,a.jsx)(h.$,{}),"Approve"]}):(0,a.jsxs)("button",{className:(0,x.m)("btn-primary flex items-center justify-center gap-4",t),onClick:()=>b(),disabled:g,children:[v&&(0,a.jsx)(h.$,{}),s]})}},34776:function(e,t,s){"use strict";s.d(t,{Z:function(){return ConnectBtn}});var a=s(57437),n=s(14701);function ConnectBtn(){return(0,a.jsx)(n.NL,{chainStatus:"none",showBalance:!1})}},80547:function(e,t,s){"use strict";s.d(t,{W:function(){return AssetInput}});var a=s(57437),n=s(81628),l=s(20373),r=s(57042),i=s(2265),c=s(28881),o=s(16775),d=s(51549);function AssetInput(e){let{asset:t="ETH",checkBalance:s=!0,balance:u,balanceTit:m="Balance",balanceDecimals:x=18,exchange:h,readonly:f,selected:b,onClick:p,amount:v,setAmount:g,price:k,disable:j,hasInput:y=!1,options:w,onChange:N=()=>{},defaultValue:T,balanceClassName:S="",disableNegative:A}=e,C=(0,i.useRef)(null),R=s&&void 0!==u&&(0,n.su)("number"==typeof v?v+"":v||"")>("bigint"==typeof u?u:0n);return(0,a.jsxs)("div",{className:"relative w-full",onClick:()=>{p&&!j&&p()},children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("div",{className:"absolute flex items-center gap-2 top-1/2 left-4 -translate-y-1/2",children:[(0,a.jsx)(d.c,{size:24,symbol:t}),(0,a.jsxs)("div",{className:"text-base font-medium",children:[(0,a.jsxs)("div",{children:[y?(0,a.jsx)(c.ZP,{options:w,onChange:N,defaultValue:T,styles:{control:(e,t)=>({...e,border:"0px",minHeight:"24px",padding:"0px",background:"rgb(248 250 252)"})}}):(0,a.jsx)("div",{children:t}),k&&(0,a.jsx)("div",{className:"text-neutral-500 text-xs",children:k})]}),h&&(0,a.jsxs)("div",{className:"text-slate-500 text-xs",children:["~$",h]})]})]}),(0,a.jsx)("input",{value:v,onChange:e=>{let t=(e.target.value||"").replaceAll("-","").replaceAll("+","");g(t)},ref:C,type:"number",disabled:j,className:(0,r.Z)(f?"bg-slate-50":"bg-white",{"border-green-700 border-2":b,"border-red-400 !border-2 focus:border-red-400":R,"border-slate-400  focus:border-blue-400":!R&&!b},"w-full h-14 text-right pr-4 pl-[8rem] font-bold text-2xl border focus:border-2 text-slate-700 rounded-md outline-none "),placeholder:"0.000",pattern:"[0-9.]{36}",step:.01,title:"",readOnly:f})]}),void 0!=u&&(0,a.jsxs)("div",{className:"flex items-center justify-between mt-1 px-1 text-slate-400 text-sm",children:[(0,a.jsxs)("div",{className:S,children:[(0,a.jsxs)("span",{children:[m,": ",(0,l.Rp)(u,3,x)]}),(0,a.jsx)("button",{className:"text-indigo-500 ml-2",onClick:()=>{let e=(0,o.b)(u,x);g(e),p&&!j&&p()},children:"Max"})]}),(0,a.jsx)("div",{className:"text-sm text-red-400",children:R?"Insufficient account balance":""})]})]})}},51549:function(e,t,s){"use strict";s.d(t,{c:function(){return CoinIcon}});var a=s(57437);function CoinIcon(e){let{symbol:t,size:s=48,...n}=e;return(0,a.jsx)("img",{...n,width:s,height:s,src:"/".concat(t,".svg"),alt:t})}},72084:function(e,t,s){"use strict";s.d(t,{$:function(){return Spinner}});var a=s(57437);let Spinner=e=>{let{className:t}=e;return(0,a.jsxs)("svg",{fill:"none",className:t?"text-white":"animate-spin h-5 w-5 2-ml-1 2mr-3",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}},64020:function(e,t,s){"use strict";s.d(t,{C:function(){return Tip}});var a=s(57437),n=s(75224),l=s(40311);function Tip(e){let{children:t,node:s}=e,r=document.getElementById("tooltip-root");return(0,a.jsx)(n.zt,{children:(0,a.jsxs)(n.fC,{children:[(0,a.jsx)(n.xz,{asChild:!0,children:s?(0,a.jsx)("div",{className:"inline-block cursor-default",style:{verticalAlign:"text-bottom"},children:s}):(0,a.jsx)("div",{className:"inline-block px-[3px] cursor-default relative",style:{transform:"translateY(-6%)"},children:(0,a.jsx)(l.apP,{className:"inline-block stroke-slate-500",style:{fontSize:"1.3em"}})})}),(0,a.jsx)(n.h_,{container:r,children:(0,a.jsxs)(n.VY,{className:"max-w-xs text-sm text-white bg-slate-900 rounded-md p-4",children:[t,(0,a.jsx)(n.Eh,{})]})})]})})}},43003:function(e,t,s){"use strict";s.d(t,{R:function(){return useWrapContractWrite}});var a=s(81628),n=s(2265),l=s(71424),r=s(56926);function useWrapContractWrite(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],[s,i]=(0,n.useState)(!1),[c,o]=(0,n.useState)(!1),d=(0,r.t_)(),{data:u}=(0,r.py)(),m=!d||!u||!u.account||s||!e||"object"==typeof e&&!1==e.enabled,write=async()=>{if(!m){i(!0),o(!1);try{let s="function"==typeof e?await e():e,{request:a}=await d.simulateContract({account:u.account,...s}),n=await u.writeContract(a),r=await d.waitForTransactionReceipt({hash:n});if("success"!==r.status)throw"Transaction reverted";o(!0),s.onSuccess&&s.onSuccess({}),t&&l.A.success("Transaction success")}catch(e){t&&l.A.error((0,a.az)(e))}i(!1)}};return{write,isDisabled:m,isLoading:s,isSuccess:c}}},20373:function(e,t,s){"use strict";s.d(t,{Rp:function(){return displayBalanceWithUnit},ZM:function(){return displayBalanceWithoutFormat},dq:function(){return displayBalance}});var a=s(16775),n=s(79352);let displayBalanceWithUnit=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,s=arguments.length>2?arguments[2]:void 0;if(!e)return"0.000";let n=10**t;return(Math.floor(Number((0,a.b)(e,s))*n)/n).toLocaleString("en-US",{maximumFractionDigits:t,minimumFractionDigits:t})},displayBalance=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(!e)return"0.000";let s=Number((0,n.d)(e)),a=Number((.1**t).toFixed(t));return s>0&&s<a?"<"+a:s<0&&s>-a?">-"+a:s.toLocaleString("en-US",{maximumFractionDigits:t,minimumFractionDigits:t})},displayBalanceWithoutFormat=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(!e)return"0.000";let s=10**t;return String(Math.floor(Number((0,n.d)(e))*s)/s)}}},function(e){e.O(0,[1866,9472,1787,4102,6691,7240,4725,754,930,9356,8156,2128,9724,4322,2971,2472,1744],function(){return e(e.s=62166)}),_N_E=e.O()}]);