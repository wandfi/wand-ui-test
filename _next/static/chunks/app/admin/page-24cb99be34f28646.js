(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{65967:function(e,t,a){Promise.resolve().then(a.bind(a,5970))},5970:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return AdminPage}});var n=a(57437),l=a(76036),s=a(84486),r=a(72009),u=a(14389),c=a(54415),o=a(57042),i=a(2265),p=a(28881),d=a(99888),f=a(21693),v=a(16775),m=a(43977);let b=[{label:"资产利息率",value:"Y"},{label:"目标AAR",value:"AART"},{label:"安全AAR",value:"AARS"},{label:"上顶AAR",value:"AARU"},{label:"熔断AAR",value:"AARC"},{label:"赎回手续费",value:"C"},{label:"进入国库比例",value:"TreasuryFeeRate"},{label:"Discount冷静时间",value:"CircuitBreakPeriod",units:0},{label:"低买池最小成交量USB",value:"PtyPoolMinUsbAmount"},{label:"高卖池最小成交量",value:"PtyPoolMinAssetAmount"}];function AdminPage(){let e=(0,u.p)(),t=(0,i.useMemo)(()=>b.map(e=>({...e,label:"".concat(e.label,"(").concat(e.value,")")})),[]),a=r.iK[e],[{name:A,value:h,vault:x,param:w},g]=(0,d.Z)({name:"Y",value:"",vault:a[0].vault,param:t[0]}),{data:y}=(0,c.uX)({contracts:b.map(t=>({abi:s.$4,address:r.e_[e],functionName:"vaultParamValue",args:[x,(0,f.$G)(t.value,{size:32})]})),watch:!0}),j=(0,i.useMemo)(()=>(y||[]).map((e,t)=>{let a=b[t];return"".concat(a.label,"(").concat(a.value,"): ").concat((0,v.b)(e.result||0n,"number"==typeof a.units?a.units:10))}),[y]),C=(0,i.useMemo)(()=>a.map(e=>({label:e.assetTokenSymbol+e.version,value:e.vault})),[]),N="number"==typeof w.units?w.units:10;return(0,n.jsx)("div",{className:"w-full flex",children:(0,n.jsxs)("div",{className:"flex flex-col gap-1 w-full max-w-[500px] mx-auto",children:[(0,n.jsx)(p.ZP,{defaultValue:C[0],options:C,onChange:e=>g({vault:null==e?void 0:e.value})}),(0,n.jsx)(p.ZP,{defaultValue:t[0],options:t,onChange:e=>g({name:null==e?void 0:e.value})}),(0,n.jsx)("input",{value:h.toString(),onChange:e=>{let t=(e.target.value||"").replaceAll("-","").replaceAll("+","");g({value:t})},type:"number",className:(0,o.Z)("bg-white border-slate-400  focus:border-blue-400 ","w-full h-14 text-right pr-4 font-bold text-2xl border focus:border-2 text-slate-700 rounded-md outline-none"),pattern:"[0-9.]{36}",step:1,placeholder:"0"}),(0,n.jsx)(l.v,{tx:"Update",config:{abi:s.$4,address:r.e_[e],functionName:"updateVaultParamValue",args:[x,(0,f.$G)(A,{size:32}),(0,m.v)(h,N)]},onTxSuccess:()=>{g({value:""})},className:"btn-primary flex items-center justify-center gap-4"}),(0,n.jsx)("div",{className:"text-sm flex flex-col items-start",children:j.map((e,t)=>(0,n.jsx)("div",{children:e},"info_".concat(t)))})]})})}},76036:function(e,t,a){"use strict";a.d(t,{v:function(){return ApproveAndTx}});var n=a(57437),l=a(72009),s=a(81628),r=a(2265),u=a(71424),c=a(56926),o=a(84661),i=a(54415);let p={},useApproves=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10000000000n*10n**18n,{address:n}=(0,c.mA)(),d=(0,i.uT)(),{data:f}=(0,c.py)(),[v,m]=(0,r.useState)(!1),b=(0,r.useMemo)(()=>Object.keys(e).filter(e=>e!==l.K8),[e]),[A,h]=(0,r.useState)(t&&p[t]||{}),updateAllownce=(e,a)=>{t&&(p[t]={...p[t]||{},[e]:a},h(t=>({...t,[e]:a})))},{data:x}=(0,c.Ov)(),w=(0,c.t_)();(0,r.useEffect)(()=>{n&&t&&b.forEach(e=>{d({abi:o.em,address:e,functionName:"allowance",args:[n,t]}).then(t=>updateAllownce(e,t||0n)).catch(console.error)})},[b,n,x]);let[g,y]=(0,r.useState)(!1),j=(0,r.useMemo)(()=>b.filter(t=>(0,s.ok)(e,t)>0n&&(0,s.ok)(e,t)>(0,s.ok)(A,t)),[e,b,A]),approve=async()=>{if(0!=j.length&&t)try{y(!0),m(!1);for(let n=0;n<j.length;n++){let l=j[n],s=!1===a?e[l]:a,r=await (null==f?void 0:f.writeContract({abi:o.em,address:l,functionName:"approve",args:[t,s]}));r&&await (null==w?void 0:w.waitForTransactionReceipt({hash:r})),updateAllownce(l,s)}u.A.success("Approve success"),y(!1),m(!0)}catch(e){throw u.A.error((0,s.az)(e)),y(!1),m(!1),e}};return{approve,loading:g,shouldApprove:j.length>0,isSuccess:v}};var d=a(43003),f=a(35769),v=a(72084);function ApproveAndTx(e){let{className:t,tx:a,approves:l,spender:s,requestAmount:u,config:c,toast:o=!0,disabled:i,onTxSuccess:p,onApproveSuccess:m}=e,{write:b,isDisabled:A,isLoading:h}=(0,d.R)({onSuccess:()=>p&&p(),...c},o),x=i||A||h||!1===c.enabled,{approve:w,shouldApprove:g,loading:y,isSuccess:j}=useApproves(l||{},s,u),C=(0,r.useRef)();return(C.current=m,(0,r.useEffect)(()=>{C.current&&j&&C.current()},[j]),g)?(0,n.jsxs)("button",{className:(0,f.m)("btn-primary flex items-center justify-center gap-4",t),onClick:w,disabled:i||!w||y,children:[y&&(0,n.jsx)(v.$,{}),"Approve"]}):(0,n.jsxs)("button",{className:(0,f.m)("btn-primary flex items-center justify-center gap-4",t),onClick:()=>b(),disabled:x,children:[h&&(0,n.jsx)(v.$,{}),a]})}},72084:function(e,t,a){"use strict";a.d(t,{$:function(){return Spinner}});var n=a(57437);let Spinner=e=>{let{className:t}=e;return(0,n.jsxs)("svg",{fill:"none",className:t?"text-white":"animate-spin h-5 w-5 2-ml-1 2mr-3",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}},43003:function(e,t,a){"use strict";a.d(t,{R:function(){return useWrapContractWrite}});var n=a(81628),l=a(2265),s=a(71424),r=a(56926);function useWrapContractWrite(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],[a,u]=(0,l.useState)(!1),[c,o]=(0,l.useState)(!1),i=(0,r.t_)(),{data:p}=(0,r.py)(),d=!i||!p||!p.account||a||!e||"object"==typeof e&&!1==e.enabled,write=async()=>{if(!d){u(!0),o(!1);try{let a="function"==typeof e?await e():e,{request:n}=await i.simulateContract({account:p.account,...a}),l=await p.writeContract(n),r=await i.waitForTransactionReceipt({hash:l});if("success"!==r.status)throw"Transaction reverted";o(!0),a.onSuccess&&a.onSuccess({}),t&&s.A.success("Transaction success")}catch(e){t&&s.A.error((0,n.az)(e))}u(!1)}};return{write,isDisabled:d,isLoading:a,isSuccess:c}}},99888:function(e,t,a){"use strict";var n=a(2265);t.Z=function(e){void 0===e&&(e={});var t=(0,n.useState)(e),a=t[0],l=t[1];return[a,(0,n.useCallback)(function(e){l(function(t){return Object.assign({},t,e instanceof Function?e(t):e)})},[])]}}},function(e){e.O(0,[1866,4102,7240,4725,9356,9724,2971,2472,1744],function(){return e(e.s=65967)}),_N_E=e.O()}]);